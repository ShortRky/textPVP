<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text MMORPG</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #222; color: #fff; text-align: center; }
        #game, #login, #devMenu { max-width: 600px; margin: 20px auto; padding: 20px; background: #333; border-radius: 10px; }
        button { margin: 5px; padding: 10px; cursor: pointer; }
        #chatbox { height: 100px; overflow-y: scroll; background: #444; padding: 10px; }
    </style>
</head>
<body>
    <div id="login">
        <h2>Login to Play</h2>
        <input type="text" id="username" placeholder="Enter your name">
        <button onclick="login()">Start Adventure</button>
    </div>
    
    <div id="game" style="display:none;">
        <h2>Welcome, <span id="playerName"></span></h2>
        <p><span id="gameText">What would you like to do?</span></p>
        <button onclick="explore()">Explore</button>
        <button onclick="viewStats()">Stats</button>
        <button onclick="openChat()">Chat</button>
        <button onclick="recruitTeammate()">Recruit Teammate</button>
        
        <div id="battle" style="display:none;">
            <p><span id="enemyText"></span></p>
            <button onclick="attack('normal')">Attack</button>
            <button onclick="attack('heavy')">Heavy Attack</button>
            <button onclick="defend()">Defend</button>
            <button onclick="run()">Run</button>
        </div>
        
        <div id="chat" style="display:none;">
            <h3>Chat</h3>
            <div id="chatbox"></div>
            <input type="text" id="chatInput" placeholder="Type a message">
            <button onclick="sendMessage()">Send</button>
        </div>
    </div>

    <div id="devMenu" style="display:none;">
        <h2>Developer Menu</h2>
        <button onclick="grantXP()">Grant 100 XP</button>
        <button onclick="addCard()">Get Random Card</button>
        <button onclick="heal()">Heal to Full</button>
    </div>

    <script>
        let player = JSON.parse(localStorage.getItem('player')) || { name: '', hp: 100, xp: 0, level: 1, cards: [], team: [] };
        let enemy = null;
        let chatMessages = JSON.parse(localStorage.getItem("chatMessages")) || [];

        function login() {
            let username = document.getElementById('username').value;
            if (username.trim() === '') return;
            player.name = username;
            saveGame();
            document.getElementById('playerName').innerText = player.name;
            document.getElementById('login').style.display = 'none';
            document.getElementById('game').style.display = 'block';
            if (player.name === 'DevNSUU') {
                document.getElementById('devMenu').style.display = 'block';
            }
        }
        
        function saveGame() {
            localStorage.setItem('player', JSON.stringify(player));
        }
        
        function explore() {
            let event = Math.random();
            if (event < 0.5) {
                startBattle();
            } else {
                document.getElementById('gameText').innerText = "You found some gold!";
            }
            saveGame();
        }
        
        function recruitTeammate() {
            let newTeammate = { name: `Ally${player.team.length + 1}`, hp: 80, attack: 10 };
            player.team.push(newTeammate);
            document.getElementById('gameText').innerText = `You recruited ${newTeammate.name}!`;
            saveGame();
        }
        
        function grantXP() {
            player.xp += 100;
            document.getElementById('gameText').innerText = "Developer granted 100 XP!";
            saveGame();
        }
        
        function addCard() {
            let cards = ["Attack Boost", "Defense Shield", "XP Bonus"];
            let chosenCard = cards[Math.floor(Math.random() * cards.length)];
            player.cards.push(chosenCard);
            document.getElementById('gameText').innerText = `Dev granted card: ${chosenCard}`;
            saveGame();
        }
        
        function heal() {
            player.hp = 100;
            document.getElementById('gameText').innerText = "Fully healed!";
            saveGame();
        }
        
        function viewStats() {
            alert(`Name: ${player.name}\nHP: ${player.hp}\nLevel: ${player.level}\nXP: ${player.xp}\nCards: ${player.cards.join(", ")}\nTeam: ${player.team.map(t => t.name).join(", ")}`);
        }
    </script>
</body>
</html>
