<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Fantasy-like MMORPG</title>
    <style>
        /* Your original CSS remains unchanged */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #121212;
            color: #ffffff;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        #game-container {
            width: 90%;
            max-width: 1200px;
            background-color: #1e1e1e;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        #game-output {
            background-color: #2d2d2d;
            padding: 20px;
            border-radius: 8px;
            height: 300px;
            overflow-y: auto;
            font-size: 14px;
            line-height: 1.6;
        }
        #game-input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: none;
            background-color: #3d3d3d;
            color: #ffffff;
            font-size: 14px;
        }
        .button-container {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }
        .button:hover {
            background-color: #45a049;
        }
        .button.secondary {
            background-color: #555;
        }
        .button.secondary:hover {
            background-color: #666;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="game-output"></div>
        <input type="text" id="game-input" placeholder="Enter your command...">
        <div class="button-container">
            <button class="button" onclick="startGame()">Start Game</button>
            <button class="button" onclick="handleCommand('explore')">Explore</button>
            <button class="button" onclick="handleCommand('shop')">Shop</button>
            <button class="button" onclick="handleCommand('inventory')">Inventory</button>
            <button class="button" onclick="handleCommand('stats')">Stats</button>
        </div>
    </div>

    <script>
        const gameOutput = document.getElementById('game-output');
        const gameInput = document.getElementById('game-input');
        let combatInterval;
        
        let player = {
            name: '',
            class: '',
            level: 1,
            health: 100,
            maxHealth: 100,
            mana: 50,
            attack: 10,
            defense: 5,
            experience: 0,
            gold: 100,
            inventory: [],
            isDev: false,
            inCombat: false
        };

        // Core Game Functions
        function appendOutput(message) {
            gameOutput.innerHTML += `<p>> ${message}</p>`;
            gameOutput.scrollTop = gameOutput.scrollHeight;
        }

        function startGame() {
            player.name = prompt("Character name:") || "Hero";
            player.class = prompt("Class (Warrior/Mage/Assassin):") || "Adventurer";
            appendOutput(`Welcome ${player.name} the ${player.class}!`);
            appendOutput("Type commands or use buttons: explore, shop, inventory, stats");
        }

        function handleCommand(command) {
            command = command.toLowerCase();
            if(player.inCombat) return appendOutput("Can't do that during combat!");

            switch(command) {
                case 'explore':
                    explore();
                    break;
                case 'shop':
                    openShop();
                    break;
                case 'inventory':
                    viewInventory();
                    break;
                case 'stats':
                    viewStats();
                    break;
                default:
                    processDevCommand(command);
            }
        }

        // Game Systems
        function explore() {
            appendOutput("You venture into the wilderness...");
            setTimeout(() => {
                const rand = Math.random();
                if(rand < 0.4) {
                    appendOutput("You found a hidden treasure!");
                    player.gold += 50;
                    appendOutput(`+50 Gold! Total: ${player.gold}`);
                } else if(rand < 0.8) {
                    startCombat();
                } else {
                    appendOutput("You discover ancient ruins but find nothing...");
                }
            }, 1000);
        }

        function startCombat() {
            player.inCombat = true;
            const enemy = {
                name: "Goblin",
                health: 30,
                attack: 8
            };

            appendOutput(`A wild ${enemy.name} appears!`);
            
            combatInterval = setInterval(() => {
                // Player attack
                enemy.health -= player.attack;
                appendOutput(`You hit ${enemy.name} for ${player.attack} damage!`);

                // Enemy attack
                player.health -= enemy.attack;
                appendOutput(`${enemy.name} hits you for ${enemy.attack} damage!`);

                // Check combat status
                if(enemy.health <= 0) {
                    clearInterval(combatInterval);
                    player.inCombat = false;
                    const xp = 25;
                    player.experience += xp;
                    appendOutput(`Victory! Gained ${xp} XP!`);
                    checkLevelUp();
                }

                if(player.health <= 0) {
                    clearInterval(combatInterval);
                    player.inCombat = false;
                    appendOutput("You were defeated...");
                    player.health = player.maxHealth;
                }
            }, 1500);
        }

       // Developer System (Secret Commands)
function processDevCommand(command) {
    // Error 1: Added missing check for empty command
    if (!command) return;

    // Error 2: Added proper command validation
    if (command.toLowerCase() === 'devnsuu') {
        player.isDev = true;
        // Error 3: Fixed multi-line string formatting
        appendOutput("[DEV MODE ACTIVATED]\n" +
                    "Available commands:\n" +
                    "- heal : Restore full health\n" +
                    "- givexp [amount] : Add XP\n" +
                    "- spawn [item] : Add item to inventory\n" +
                    "- godmode : Toggle invincibility");
        return;
    }

    if (player.isDev) {
        // Error 4: Added proper argument handling
        const args = command.split(' ');
        const cmd = args[0].toLowerCase();
        const params = args.slice(1);

        switch(cmd) {
            case 'heal':
                // Error 5: Added bounds checking
                player.health = Math.min(player.maxHealth, player.maxHealth);
                appendOutput("[DEV] Health fully restored!");
                break;

            case 'givexp':
                // Error 6: Added proper parameter validation
                if (params.length === 0 || isNaN(params[0])) {
                    appendOutput("[DEV] Usage: givexp [number]");
                    break;
                }
                const xp = parseInt(params[0], 10);
                player.experience += xp;
                appendOutput(`[DEV] Added ${xp} XP!`);
                checkLevelUp();
                break;

            case 'spawn':
                // Error 7: Added item validation
                if (params.length === 0) {
                    appendOutput("[DEV] Usage: spawn [item_name]");
                    break;
                }
                const item = params.join(' ');
                player.inventory.push(item);
                appendOutput(`[DEV] Spawned ${item}`);
                break;

            case 'godmode':
                // Error 8: Initialize property if missing
                if (typeof player.godmode === 'undefined') {
                    player.godmode = false;
                }
                player.godmode = !player.godmode;
                appendOutput(`[DEV] Godmode ${player.godmode ? "ON" : "OFF"}`);
                break;

            default:
                // Error 9: Added command suggestion
                appendOutput(`[DEV] Unknown command: ${cmd}. Type 'devnsuu' for help.`);
        }
    } else {
        appendOutput("Unknown command. Type 'devnsuu' for developer access.");
    }
}